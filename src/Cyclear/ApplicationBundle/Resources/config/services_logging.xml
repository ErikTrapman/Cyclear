<?xml version="1.0" encoding="UTF-8"?>
<container xmlns="http://symfony.com/schema/dic/services">
    <services>

        <service id="cyclear_game.exceptionlistener.db" class="Cyclear\ApplicationBundle\Listener\ExceptionListener">
            <tag name="kernel.event_listener" event="kernel.exception"
                 method="onKernelException"/>
            <argument type="service" id="dblog"/>
        </service>

        <service id="dblog" alias="cyclear.logger.db"/>
        <service id="dbloghandler" alias="cyclear.logger.handler.db"/>

        <service id="cyclear.logger.db" class="Symfony\Bridge\Monolog\Logger">
            <argument index="0">cyclear</argument>
            <call method="pushHandler">
                <argument type="service" id="dbloghandler"/>
            </call>
        </service>

        <service id="cyclear.logger.handler.db" class="Cyclear\ApplicationBundle\Log\CyclearLogHandlerDb">
            <argument key="level">100</argument>
            <argument key="bubble">false</argument>
            <argument type="service" id="pdo"/>
        </service>

    </services>
</container>
