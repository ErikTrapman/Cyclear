<?xml version="1.0" ?>
<!-- 100 => 'DEBUG', 200 => 'INFO', 300 => 'WARNING', 400 => 'ERROR', 500 
=> 'CRITICAL', 550 => 'ALERT', -->
<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:monolog="http://symfony.com/schema/dic/monolog"
           xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd
    		http://symfony.com/schema/dic/monolog http://symfony.com/schema/dic/monolog/monolog-1.0.xsd">

    <services>
        <service id="cyclear_game.exceptionlistener.db" class="Cyclear\GameBundle\Listener\ExceptionListener">
            <tag name="kernel.event_listener" event="kernel.exception"
                 method="onKernelException" />
            <argument type="service" id="dblog" />
        </service>
        
        <service id="cyclear_game.requestlistener" class="Cyclear\GameBundle\Listener\RequestListener">
            <argument type="service" id="doctrine.orm.entity_manager" />
            <argument type="service" id="security.context" />
            <tag name="kernel.event_listener" event="kernel.request" method="onKernelRequest" />
        </service>

        <service id="cyclear_game.exceptionlistener.mail" class="Cyclear\GameBundle\Listener\ExceptionListener">
            <tag name="kernel.event_listener" event="kernel.exception"
                 method="onKernelException" />
            <argument type="service" id="maillog" />
        </service>

        <service id="pdo" class="PDO">
            <argument key="dsn">mysql:dbname=%database_name%;host=%database_host%</argument>
            <argument key="user">%database_user%</argument>
            <argument key="pass">%database_password%</argument>
        </service>

        <service id="cyclear_game.manager.transfer" class="Cyclear\GameBundle\EntityManager\TransferManager">
            <argument type="service" id="doctrine.orm.entity_manager" />
            <argument type="service" id="cyclear_game.manager.contract" />
        </service>
        
        <service id="cyclear_game.manager.wedstrijd" class="Cyclear\GameBundle\EntityManager\WedstrijdManager">
            <argument type="service" id="cyclear_cqparser.parser"/>
        </service>
            
        <service id="cyclear_game.manager.uitslag" class="Cyclear\GameBundle\EntityManager\UitslagManager">
            <argument type="service" id="doctrine.orm.entity_manager" />
            <argument type="service" id="cyclear_cqparser.parser"/>
            <argument type="service" id="cyclear_game.calculator.punten"/>
            <argument>%cq_ranking-wedstrijdurl%</argument>
        </service>
        
        <service id="cyclear_game.manager.user" class="Cyclear\GameBundle\EntityManager\UserManager">
            <argument type="service" id="security.acl.provider"/>
        </service>
        
        <service id="cyclear_game.manager.contract" class="Cyclear\GameBundle\EntityManager\ContractManager">
            <argument type="service" id="doctrine.orm.entity_manager" />
        </service>
        
        <service id="cyclear_game.type.renner_selector" class="Cyclear\GameBundle\Form\RennerSelectorType">
            <argument type="service" id="doctrine.orm.entity_manager"/>
            <tag name="form.type" alias="renner_selector" />
        </service>
        
        <service id="cyclear_game.type.renner_autocomplete" class="Cyclear\GameBundle\Form\RennerAutocompleteType">
            <tag name="form.type" alias="renner_autocomplete" />
        </service>
        
        <service id="cyclear_game.type.filter.ploeg" class="Cyclear\GameBundle\Form\Filter\PloegFilterType">
            <argument type="service" id="doctrine.orm.entity_manager"/>
            <tag name="form.type" alias="ploeg_filter" />
        </service>
        
        <service id="cyclear_game.type.filter.renner" class="Cyclear\GameBundle\Form\Filter\RennerFilterType">
            <tag name="form.type" alias="renner_filter" />
        </service>
        
        <service id="cyclear_game.transfer_repository" class="Cyclear\GameBundle\Entity\TransferRepository"
                 factory-service="doctrine.orm.entity_manager"
                 factory-method="getRepository">
            <argument>Cyclear\GameBundle\Entity\Transfer</argument>
        </service>
        
        <service id="cyclear_game.calculator.punten" class="Cyclear\GameBundle\Calculator\PuntenCalculator">
            <argument type="service" id="doctrine.orm.entity_manager"/>   
        </service>
        
        
        <service id="crawler" class="Symfony\Component\DomCrawler\Crawler"/>
        <!-- FOS User Bundle -->
        <service id="cyclear_game.user_registration.form.type" class="Cyclear\GameBundle\Form\UserType">
            <tag name="form.type" alias="admin_user_new" />
            <argument>%fos_user.model.user.class%</argument>
        </service>
        <service id="cyclear_game.user_edit.form.type" class="Cyclear\GameBundle\Form\UserEditType">
            <tag name="form.type" alias="admin_user_edit" />
            <argument>%fos_user.model.user.class%</argument>
        </service>
        
        <service id="cyclear_game.user_form.handler.registration" class="Cyclear\GameBundle\Form\Handler\UserFormHandler" scope="request" public="false">
            <argument type="service" id="fos_user.registration.form" />
            <argument type="service" id="request" />
            <argument type="service" id="fos_user.user_manager" />
            <argument type="service" id="fos_user.mailer" />
            <argument type="service" id="doctrine.orm.entity_manager" />
            <argument type="service" id="security.acl.provider"/>
        </service>
        
        
        <service id="cyclear_game.validator.usertransfer" class="Cyclear\GameBundle\Validator\Constraints\UserTransferValidator">
            <argument type="service" id="doctrine.orm.default_entity_manager" />
            <tag name="validator.constraint_validator" alias="user_transfer" />
        </service>
        
        <service class="Cyclear\GameBundle\EventListener\UserCreateListener" >
            <argument type="service" id="fos_user.user_manager" />
            <argument type="service" id="fos_user.mailer" />
            <argument type="service" id="doctrine.orm.entity_manager" />
            <argument type="service" id="security.acl.provider"/>
            <tag name="kernel.event_subscriber"/>
        </service>
        
        
    </services>

    <!-- <parameters> <parameter key="cyclear_game.example.class">Cyclear\GameBundle\Example</parameter> 
  		</parameters> <services> <service id="cyclear_game.example" class="%cyclear_game.example.class%"> 
  		<argument type="service" id="service_id" /> <argument>plain_value</argument> 
  		<argument>%parameter_name%</argument> </service> </services> -->
</container>
